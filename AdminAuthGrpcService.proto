syntax = "proto3";
package admin_auth;
import "google/protobuf/empty.proto";

enum AuthError{
    LoginAlreadyInUse = 0;
    UserNotFound = 1;
    InvalidLogin = 2;
    InvalidPassword = 3;
    InvalidToken = 4;
    StaleToken = 5;
}

message AdminAuthRegisterUserGrpcRequest{
    string Login = 1;
    string Password = 2;
}

message AdminAuthRegisterUserGrpcResponse{
    optional AuthError Error = 1;
    optional string AuthToken = 2;
    optional string RefreshToken = 3;
}

message AdminAuthUpdatePasswordGrpcRequest{
    string Login = 1;
    string NewPassword = 2;
}

message AdminAuthUpdatePasswordGrpcResponse{
    optional AuthError Error = 1;
    optional string AuthToken = 2;
    optional string RefreshToken = 3;
}

message AdminAuthenticateGrpcRequest{
    string Login = 1;
    string Password = 2;
}

message AdminAuthenticateGrpcResponse{
    optional AuthError Error = 1;
    optional string AuthToken = 2;
    optional string RefreshToken = 3;
}

message AdminAuthRefreshGrpcRequest{
    string RefreshToken = 1;
}

message AdminAuthRefreshGrpcResponse{
    optional AuthError Error = 1;
    optional string AuthToken = 2;
    optional string RefreshToken = 3;
}

message AdminAuthValidateJwtRequest{
    string AuthToken = 1;
}

message AdminAuthValidateJwtResponse{
    optional AuthError Error = 1;
}

message AdminAuthCreateGroupGrpcRequest{
    string Name = 1;
    string Description = 2;
}

message AdminAuthCreateGroupGrpcResponse{
    optional string GroupId = 1;
}

message AdminAuthCreatePermissionGrpcRequest{
    string Name = 1;
    string Description = 2;
}

message AdminAuthCreatePermissionGrpcResponse{
    optional string PermissionId = 1;
}

message AdminAuthGoogleGrpcRequest{
    string IdToken = 1;
}

message AdminAuthGoogleGrpcResponse{
    optional AuthError Error = 1;
    optional string AuthToken = 2;
    optional string RefreshToken = 3;
}

message AdminAuthAddUserToGroupGrpcRequest{
    string UserId = 1;
    string GroupId = 2;
}

message AdminAuthRemoveUserFromGroupGrpcRequest{
    string UserId = 1;
    string GroupId = 2;
}

message AdminAuthAddPermissionToGroupGrpcRequest{
    string GroupId = 1;
    string PermissionId = 2;
}

message AdminAuthRemovePermissionFromGroupGrpcRequest{
    string GroupId = 1;
    string PermissionId = 2;
}

service AdminAuthService {
    rpc AddUserToGroup(AdminAuthAddUserToGroupGrpcRequest) returns (google.protobuf.Empty);
    rpc RemoveUserFromGroup(AdminAuthRemoveUserFromGroupGrpcRequest) returns (google.protobuf.Empty);
    rpc AddPermissionToGroup(AdminAuthAddPermissionToGroupGrpcRequest) returns (google.protobuf.Empty);
    rpc RemovePermissionFromGroup(AdminAuthRemovePermissionFromGroupGrpcRequest) returns (google.protobuf.Empty);
    rpc Register(AdminAuthRegisterUserGrpcRequest) returns (AdminAuthRegisterUserGrpcResponse);
    rpc AuthenticateGoogle(AdminAuthGoogleGrpcRequest) returns (AdminAuthGoogleGrpcResponse);
    rpc Refresh(AdminAuthRefreshGrpcRequest) returns (AdminAuthRefreshGrpcResponse);
    rpc UpdatePassword(AdminAuthUpdatePasswordGrpcRequest) returns (AdminAuthUpdatePasswordGrpcResponse);
    rpc Authenticate(AdminAuthenticateGrpcRequest) returns (AdminAuthenticateGrpcResponse);
    rpc CreateGroup(AdminAuthCreateGroupGrpcRequest) returns (AdminAuthCreateGroupGrpcResponse);
    rpc CreatePermission(AdminAuthCreatePermissionGrpcRequest) returns (AdminAuthCreatePermissionGrpcResponse);
    rpc Validate(AdminAuthValidateJwtRequest) returns (AdminAuthValidateJwtResponse);
    rpc Ping(google.protobuf.Empty) returns (google.protobuf.Empty);
}
