
syntax = "proto3";
package yft_auth;
import "google/protobuf/empty.proto";

enum AuthError {
    LoginAlreadyInUse        = 0;
    AuthCreadsNotFound       = 1;
    InvalidLogin             = 2;
    InvalidPassword          = 3;

    LoginTooShort            = 4;
    LoginTooLong             = 5;
    LoginHasWhitespace       = 6;
    LoginInvalidChars        = 7;
    
    EmailMissingAt           = 8;
    EmailLocalTooLong        = 9;
    EmailDomainTooLong       = 10;
    EmailLocalDotRules       = 11;
    EmailLocalInvalidChars   = 12;
    EmailDomainNoDot         = 13;
    EmailLabelEmpty          = 14;
    EmailLabelTooLong        = 15;
    EmailLabelEdgeHyphen     = 16;
    EmailLabelInvalidChars   = 17;
    EmailTldInvalid          = 18;

    PasswordTooShort         = 19;
    PasswordTooLong          = 20;
    PasswordMissingUppercase = 21;
    PasswordMissingNumber    = 22;
    PasswordMissingSpecial   = 23;

    InvalidBrandName         = 24;
}

message AuthRegisterClientGrpcRequest{
    string Login = 1;
    string Password = 2;
}

message AuthRegisterClientGrpcResponse{
    optional AuthError Error = 1;
    optional string AuthToken = 2;
    optional string RedirectUrl = 3;
    optional string ClientId = 4;
}

message AuthUpdatePasswordGrpcRequest{
    string ClientId = 1;
    string NewPassword = 2;
}

message AuthenticateGrpcRequest{
    string Login = 1;
    string Password = 2;
}

message AuthenticateGrpcResponse{
    optional AuthError Error = 1;
    optional string AuthToken = 2;
    optional string RedirectUrl = 3;
    optional string ClientId = 4;
}

message AuthUpdatePasswordGrpcResponse{
    optional AuthError Error = 1;
    optional string AuthToken = 2;
    optional string RedirectUrl = 3;
    optional string ClientId = 4;
}

service YftAuthService {
    rpc Register(AuthRegisterClientGrpcRequest) returns (AuthRegisterClientGrpcResponse);
    rpc UpdatePassword(AuthUpdatePasswordGrpcRequest) returns (AuthUpdatePasswordGrpcResponse);
    rpc Authenticate(AuthenticateGrpcRequest) returns (AuthenticateGrpcResponse);
    rpc Ping(google.protobuf.Empty) returns (google.protobuf.Empty);
}
